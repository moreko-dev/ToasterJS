import t from"./ToastConsts.min.js";class ToasterJS{#a=[];#b;#c;#d;#e;#f;#g;#h;#i;constructor(e={}){this.#b=e.animation||t.Animation.FADE,this.#c=e.direction||t.Direction.AUTO,this.#d=e.position||t.Position.BOTTOM_LEFT,this.#e=e.duration||2e3,this.#f=e.roundedValue||"0",this.#g=e.limit||5,this.#h=e.queue||!1,this.#j()}#j(){if(this.#i=document.querySelector(".toasterjs-toasts-container"),!this.#i){let e=document.createElement("div");e.className="toasterjs-toasts-container",this.#i=e,document.body.insertAdjacentElement("beforeend",e)}let i=t.getStyleByPosition(this.#d);this.#i.style.justifyContent=i.jc,this.#i.style.alignItems=i.ai,this.#i.style.direction=this.#c,this.#i.style.height=`${window.innerHeight-16}px`,document.addEventListener("click",t=>{let e=t.target.closest(".toasterjs-toast > .close > .close-button");e&&e.parentElement.parentElement.remove()}),window.addEventListener("resize",()=>{this.#i.style.height=`${window.innerHeight-16}px`})}toast(e,i={},s=null){if(!this.#i)return;let n=i.type||t.Type.DEFAULT,a=i.duration||this.#e,o=i.animation||this.#b,r=i.roundedValue||this.#f,l=this.#k(e,n,s);l.classList.add(o,"hide"),l.style.borderRadius=r,this.#l(l,this.#m.bind(this),l,{duration:a})}toastPending(e,i,s=null,n={}){if(!this.#i)return;let a=n.animation||this.#b,o=n.roundedValue||this.#f,r=this.#k(e,t.Type.PENDING,s);return r.classList.add(a,"hide"),r.style.borderRadius=o,this.#l(r,this.#n.bind(this),r,{action:i.action,onSuccess:i.onSuccess,onError:i.onError})}toastAction(e,i,s=null,n={}){if(!this.#i)return;let a=n.type||t.Type.QUESTION,o=n.animation||this.#b,r=n.roundedValue||this.#f,l=this.#o(e,a,i,s);l.classList.add(o,"hide"),l.style.borderRadius=r,this.#l(l,this.#p.bind(this),l)}#m(s,n={}){let a=n.duration||this.#e;this.#p(s),setTimeout(()=>{this.#q(s),this.#r()},a)}#n(o,r={}){return this.#p(o),new Promise(async(t,e)=>{try{let i=await r.action();this.#q(o),r.onSuccess(),t(i)}catch(s){this.#q(o),r.onError(),e(s)}this.#r()})}#k(l,d,c=null){let h=document.createElement("div");return h.classList.add("toasterjs-toast",d),h.innerHTML=`
            <div class="icon">${t.Icon[d.toUpperCase()]}</div>
            <div class="content">
                <span class="toasterjs-toast__title">${c??""}</span>
                <span class="toasterjs-toast__message">${l}</span>
            </div>
            <div class="close">
                <button class="close-button ti">${t.Icon.CLOSE}</button>
            </div>
        `,h}#o(u,m,p,T=null){let E=[];for(let v=0;v<p.length;v++){let y=p[v];E.push({id:v+1,uName:"action"+(v+1),name:y.name,action:y.action,closeOnClick:y.closeOnClick??!0})}let g="";for(let f of E)null!==f&&(g+=`<button class="${f.uName}" data-index="${f.id}">${f.name}</button>`);let L=document.createElement("div");for(let b of(L.classList.add("toasterjs-toast","action-toast",m),L.innerHTML=`
            <div class="icon">${t.Icon[m.toUpperCase()]}</div>
            <div class="content">
                <span class="toasterjs-toast__title">${T??""}</span>
                <span class="toasterjs-toast__message">${u}</span>
            </div>
            <div class="actions">${g}</div>
        `,E))L.querySelector(`.${b.uName}[data-index="${b.id}"]`).addEventListener("click",()=>{b.closeOnClick&&this.#q(L),this.#r(),b.action()});return L}#l(j,C,...S){if(this.#i.children.length===this.#g){if(this.#h){this.#a.push({element:j,animationFunction:C,animationFunctionArgs:S});return}this.#i.firstChild.remove(),this.#i.appendChild(j)}else this.#i.appendChild(j);return C(...S)}#p($){setTimeout(()=>{$.classList.remove("hide"),$.classList.add("show")},1)}#q(A){A.classList.remove("show"),A.classList.add("hide"),A.addEventListener("transitionend",()=>A.remove(),{once:!0})}#r(){if(this.#h&&0!==this.#a.length&&this.#i.children.length<this.#g){let O=this.#a[0];this.#i.appendChild(O.element),O.animationFunction(...O.animationFunctionArgs),this.#a.shift()}}}export default ToasterJS;